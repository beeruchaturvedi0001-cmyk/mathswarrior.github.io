<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Course Payment | MATH'S WARRIOR</title>

<style>
body{
  font-family:Arial;
  margin:0;
  padding:0;
  min-height:100vh;
  display:flex;
  justify-content:center;
  align-items:center;
  background: linear-gradient(135deg,#ff0000,#001f7f);
  color:white;
}

.payment-box{
  background:white;
  color:black;
  padding:25px;
  border-radius:15px;
  width:100%;
  max-width:400px;
  text-align:center;
  box-shadow:0 10px 25px rgba(0,0,0,0.4);
}

select,input,button{
  width:100%;
  padding:10px;
  margin:8px 0;
  border-radius:8px;
  font-size:14px;
}

button{
  background:#001f7f;
  color:white;
  font-weight:bold;
  border:none;
  cursor:pointer;
}

#status{
  font-weight:bold;
  margin-top:12px;
  color:green;
}

label{
  font-weight:bold;
  display:block;
  margin-top:10px;
  text-align:left;
}

.payment-detail{
  text-align:left;
  background:#f2f2f2;
  padding:12px;
  border-radius:10px;
  margin:10px 0;
  font-size:14px;
}

#preview{
  max-width:100%;
  margin-top:10px;
  border-radius:10px;
  display:none;
}
</style>
</head>
<body>

<div class="payment-box">
<h2>COURSE PAYMENT</h2>

<label>SELECT COURSE</label>
<select id="courseSelect" onchange="updateFee()">
  <option value="">Select Course</option>
  <option value="LAKSYA FOUNDATION BATCH|500">LAKSYA FOUNDATION BATCH - ₹500</option>
  <option value="PRATHAM TARGET BATCH|2499">PRATHAM TARGET BATCH - ₹2499</option>
  <option value="MATH SPECIAL 2.0|2099">MATH SPECIAL 2.0 - ₹2099</option>
</select>

<p class="payment-detail">
  <b>UPI ID:</b> 7705042892@axl <br>
  <b>Account Name:</b> Bhanu Pratap Chaubey <br>
  <b>Bank Name:</b> Union Bank of India <br>
  <b>Branch:</b> Patruna
</p>

<p><b>AMOUNT TO PAY: ₹<span id="courseFee">0</span></b></p>

<label>UPLOAD PAYMENT SCREENSHOT</label>
<input type="file" id="paymentScreenshot" accept="image/*">

<button onclick="submitPayment()">SUBMIT PAYMENT</button>

<p id="status"></p>
<img id="preview" src="" alt="Payment Screenshot Preview">

</div>

<script>
const courseSelect = document.getElementById("courseSelect");
const courseFeeSpan = document.getElementById("courseFee");
const status = document.getElementById("status");
const preview = document.getElementById("preview");
const screenshotInput = document.getElementById("paymentScreenshot");

function updateFee(){
  const selected = courseSelect.value;
  if(selected){
    const fee = selected.split("|")[1];
    courseFeeSpan.innerText = fee;
  } else {
    courseFeeSpan.innerText = "0";
  }
}

// Load previous payment if exists
window.onload = function(){
  const payments = JSON.parse(localStorage.getItem("payments")) || [];
  if(payments.length > 0){
    const last = payments[payments.length - 1];
    courseSelect.value = last.course + "|" + last.fee;
    updateFee();
    preview.src = last.screenshot;
    preview.style.display = "block";
    status.innerText = "✅ Payment Successfully Completed!";
  }
}

function submitPayment(){
  const selected = courseSelect.value;
  const file = screenshotInput.files[0];

  if(!selected){ alert("Select Course"); return; }
  if(!file){ alert("Upload Screenshot"); return; }

  const courseName = selected.split("|")[0];
  const fee = selected.split("|")[1];

  const reader = new FileReader();
  reader.onload = function(e){
    let payments = JSON.parse(localStorage.getItem("payments")) || [];

    // Replace previous payment for same course if exists
    const index = payments.findIndex(p => p.course === courseName);
    const paymentData = {
      course: courseName,
      fee: fee,
      screenshot: e.target.result
    };

    if(index >= 0){
      payments[index] = paymentData;
    } else {
      payments.push(paymentData);
    }

    localStorage.setItem("payments", JSON.stringify(payments));

    status.innerText = "✅ Payment Successfully Completed! Thanks for connecting with MATH'S WARRIOR";
    preview.src = e.target.result;
    preview.style.display = "block";

    screenshotInput.value = "";
  };

  reader.readAsDataURL(file);
}
</script>

</body>
</html>